!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="12a03be3-8025-4f4f-beda-2e989f7dfbb9",e._sentryDebugIdIdentifier="sentry-dbid-12a03be3-8025-4f4f-beda-2e989f7dfbb9")}catch(e){}}(),(self.webpackChunktwitch_twilight=self.webpackChunktwitch_twilight||[]).push([[82110],{748601:function(e,n,i){i.d(n,{B:function(){return l},n:function(){return a}});var r=i(331635),t=i(474848);i(296540);function a(e){return"".concat("https://static-cdn.jtvnw.net/twilight-static-assets","/").concat(e)}var l=function(e){var n=(0,r.__assign)((0,r.__assign)({},e),{children:void 0});return(0,t.jsx)("picture",(0,r.__assign)({},n,{children:e.children}))}},752760:function(e,n,i){i.d(n,{a:function(){return t},f:function(){return a}});var r,t=(r=(0,i(191132).U)({name:"HypeTrainRoot",category:"monetization"})).Available,a=r.Unavailable},309201:function(e,n,i){i.d(n,{Z_:function(){return r},UD:function(){return y}});var r,t=i(331635),a=i(727234),l=i(10982),o=i(891975),u=i(296540),d=i(267924),v=i(950386),s=i(647605),c=i(95159),f=i(726561);!function(e){e.Default="DEFAULT",e.LevelUpCTA="LEVEL_UP_CTA",e.GiftCTA="GIFT_CTA",e.UnlockRewardCTA="UNLOCK_REWARD_CTA",e.RewardRouletteCTA="REWARD_ROULETTE_CTA",e.ATHApproachingCTA="ATH_APPROACHING_CTA",e.ATHReachedCTA="ATH_REACHED_CTA",e.TreasureTrainDiscountApproachingCTA="TREASURE_TRAIN_DISCOUNT_APPROACHING_CTA"}(r||(r={}));var h,p=[r.LevelUpCTA,r.GiftCTA,r.UnlockRewardCTA,r.RewardRouletteCTA,r.ATHApproachingCTA,r.ATHReachedCTA,r.TreasureTrainDiscountApproachingCTA],T={baselineState:r.Default,currentNonDefaultIndex:p.length-1,stateLoopIntervalDuration:0,stopPending:!1};!function(e){e.NextPanel="NEXT_PANEL",e.StartInterval="START_INTERVAL",e.StopInterval="STOP_INTERVAL",e.Reset="RESET"}(h||(h={}));var g=function(e,n){switch(n.type){case h.NextPanel:if(null===n.availableNonDefaultStates)return e;if(!e.stopPending&&0!==e.stateLoopIntervalDuration&&e.baselineState===r.Default){var i=(e.currentNonDefaultIndex+1)%n.availableNonDefaultStates.length;return(0,t.__assign)((0,t.__assign)({},e),{baselineState:n.availableNonDefaultStates[i],currentNonDefaultIndex:i})}return(0,t.__assign)((0,t.__assign)({},e),{baselineState:r.Default,stateLoopIntervalDuration:e.stopPending?0:e.stateLoopIntervalDuration,stopPending:!1});case h.StartInterval:return null===n.availableNonDefaultStates?e:(0,t.__assign)((0,t.__assign)({},e),{baselineState:r.Default,stateLoopIntervalDuration:6e3,currentNonDefaultIndex:n.availableNonDefaultStates.length-1,stopPending:!1});case h.StopInterval:return e.baselineState!==r.Default?(0,t.__assign)((0,t.__assign)({},e),{stopPending:!0}):(0,t.__assign)((0,t.__assign)({},e),{stateLoopIntervalDuration:0});case h.Reset:return T;default:return e}},y=function(e){var n,i,t,d,s,p,y,R,D,E=e.bannerState,S=e.data,I=e.earnableEmoteRewardsLength,L=e.lockedEmoteRewardsLength,_=(0,a.Z)(E),C=u.useReducer(g,T),b=C[0],x=C[1],m=u.useRef(null);null===m.current&&(m.current=A({activeHypeTrain:null===(i=null===(n=null==S?void 0:S.user)||void 0===n?void 0:n.channel)||void 0===i?void 0:i.hypeTrain.execution,channelID:null===(t=null==S?void 0:S.user)||void 0===t?void 0:t.id,earnableEmoteRewardsLength:I,lockedEmoteRewardsLength:L})),u.useEffect((function(){var e,n,i;m.current=A({activeHypeTrain:null===(n=null===(e=null==S?void 0:S.user)||void 0===e?void 0:e.channel)||void 0===n?void 0:n.hypeTrain.execution,channelID:null===(i=null==S?void 0:S.user)||void 0===i?void 0:i.id,earnableEmoteRewardsLength:I,lockedEmoteRewardsLength:L})}),[null===(s=null===(d=null==S?void 0:S.user)||void 0===d?void 0:d.channel)||void 0===s?void 0:s.hypeTrain.execution,null===(p=null==S?void 0:S.user)||void 0===p?void 0:p.id,I,L]),(0,l.$)((function(){x({type:h.NextPanel,availableNonDefaultStates:m.current})}),b.baselineState!==r.Default||0===b.stateLoopIntervalDuration?b.stateLoopIntervalDuration:1e4),u.useEffect((function(){_!==E&&(E===c.SI.Baseline?x({type:h.StartInterval,availableNonDefaultStates:m.current}):x({type:h.StopInterval}))}),[E,_]),(0,o.S)((function(){E===c.SI.Baseline&&_===E&&x({type:h.StartInterval,availableNonDefaultStates:m.current})}));var w=u.useState(null),P=w[0],H=w[1];return function(e,n){void 0===n&&(n=0);var i=(0,f.F)(e);u.useEffect((function(){if(null!==n){var e=setTimeout((function(){i.current()}),n);return function(){return clearTimeout(e)}}}),[n,i])}((function(){x({type:h.StopInterval})}),P),u.useEffect((function(){var e,n,i;if(null===(i=null===(n=null===(e=null==S?void 0:S.user)||void 0===e?void 0:e.channel)||void 0===n?void 0:n.hypeTrain.execution)||void 0===i?void 0:i.expiresAt){var r=Math.max(0,(0,v.Zc)(new Date(S.user.channel.hypeTrain.execution.expiresAt))-30);H(1e3*r)}else H(0)}),[null===(D=null===(R=null===(y=null==S?void 0:S.user)||void 0===y?void 0:y.channel)||void 0===R?void 0:R.hypeTrain.execution)||void 0===D?void 0:D.expiresAt]),u.useEffect((function(){E===c.SI.Inactive&&(x({type:h.Reset}),H(null))}),[E]),{baselinePanelState:b.baselineState,pauseBaselinePanelCycle:function(){return x({type:h.StopInterval})},resumeBaselinePanelCycle:function(){var e,n,i;!(null===(i=null===(n=null===(e=null==S?void 0:S.user)||void 0===e?void 0:e.channel)||void 0===n?void 0:n.hypeTrain.execution)||void 0===i?void 0:i.expiresAt)||(0,v.Zc)(new Date(S.user.channel.hypeTrain.execution.expiresAt))<=30||x({type:h.StartInterval,availableNonDefaultStates:m.current})}}},A=function(e){var n=e.activeHypeTrain,i=e.channelID,t=e.earnableEmoteRewardsLength,a=e.lockedEmoteRewardsLength,l=!!(null==n?void 0:n.progress.level)&&n.progress.level.value>1;return(0,s.Qd)(n,i)===d.Q8_.APPROACHING?[r.ATHApproachingCTA]:(0,s.Qd)(n,i)===d.Q8_.REACHED?[r.ATHReachedCTA]:p.filter((function(e){var i,o;switch(e){case r.LevelUpCTA:return!0;case r.GiftCTA:return l&&!(null===(i=n.self)||void 0===i?void 0:i.isEligibleForRewards)&&(t>0||a>0||n.isGoldenKappaTrain);case r.UnlockRewardCTA:return l&&(t>0||a>0||n.isGoldenKappaTrain);case r.RewardRouletteCTA:return l&&t>0;case r.TreasureTrainDiscountApproachingCTA:return(null==n?void 0:n.isTreasureTrain)&&(null===(o=null==n?void 0:n.treasureTrainDetails)||void 0===o?void 0:o.status)===d.lHC.APPROACHING;default:return!1}}))}},274390:function(e,n,i){i.d(n,{A$:function(){return x},TZ:function(){return b}});var r=i(331635),t=i(474848),a=i(296540),l=i(105146),o=i(397568),u=i(752760),d=i(797920),v=i(290942),s=i(640598),c=i(982821),f=i(456450),h=function(e){var n,i,t,o=e.channelID,u=e.data,d=a.useState([]),h=d[0],p=d[1],T=null===(t=null===(i=null===(n=null==u?void 0:u.user)||void 0===n?void 0:n.channel)||void 0===i?void 0:i.hypeTrain.execution)||void 0===t?void 0:t.id,g=(0,v.Z)(T);return a.useEffect((function(){T!==g&&p((function(e){return e.filter((function(e){return e.hypeTrainID===T}))}))}),[T,g,u]),(0,s.s)({topic:(0,f.tf)(o||""),skip:!o,onMessage:function(e){if(e.type===c.PD.HypeTrainMergeTrains){var n=function(e){return{uuid:(0,l.k3)(),hypeTrainID:e.data.hypeTrain.id,previousLevel:e.data.prevProgress.level.value,newLevel:e.data.hypeTrain.progress.level.value,previousUsers:e.data.prevUsers,joiningUsers:e.data.joiningUsers}}(e);p((function(e){return(0,r.__spreadArray)((0,r.__spreadArray)([],e,!0),[n],!1)}))}}}),{nextMergeEvent:a.useMemo((function(){return h.find((function(e){return e.hypeTrainID===T}))||null}),[h,T]),removeMergeEvent:a.useCallback((function(e){p((function(n){return n.filter((function(n){return n.uuid!==e}))}))}),[p])}};var p=i(267924),T=function(e){var n,i,r,t;return null!==(t=null===(r=null===(i=null===(n=null==e?void 0:e.user)||void 0===n?void 0:n.channel)||void 0===i?void 0:i.hypeTrain.execution)||void 0===r?void 0:r.progress.total)&&void 0!==t?t:null},g=function(e){var n,i,r,t;return(null===(t=null===(r=null===(i=null===(n=null==e?void 0:e.user)||void 0===n?void 0:n.channel)||void 0===i?void 0:i.hypeTrain.execution)||void 0===r?void 0:r.sharedHypeTrainDetails)||void 0===t?void 0:t.sharedProgress)||null};function y(e,n){return e.filter((function(e){return e.user.id!==n})).filter((function(e){return"REACHED"===e.channelProgress.allTimeHighState})).map((function(e){return e.user}))}var A=i(95159),R=i(423163),D=i(313793),E=i(74950),S=i(745277),I=i(309201),L={instanceID:null,channelID:null,bannerState:A.SI.Inactive,bannerStateMetadata:null,data:void 0,isShared:!1,earnableEmoteRewards:[],lockedEmoteRewards:[],channelLogin:"",baselinePanelState:I.Z_.Default,pauseBaselinePanelCycle:function(){},resumeBaselinePanelCycle:function(){}},_=(0,o.q)("HypeTrainV2Context",L),C=_.context,b=(_.withContext,function(){return a.useContext(C)}),x=function(e){var n=e.channelID,i=e.channelLogin,a=(0,r.__rest)(e,["channelID","channelLogin"]),l=b().instanceID;return!(0,S.eM)()||l?(0,t.jsx)(t.Fragment,{children:a.children}):(0,t.jsx)(m,(0,r.__assign)({channelID:n,channelLogin:i},a))},m=function(e){var n,i,a,l,o,d,v=e.children,s=(0,r.__rest)(e,["children"]),c=w(s),f=null;return c.loading||(f=s.channelID?s.channelLogin?c.data?(null===(n=c.data)||void 0===n?void 0:n.user)?(null===(a=null===(i=c.data)||void 0===i?void 0:i.user)||void 0===a?void 0:a.channel)?(null===(d=null===(o=null===(l=c.data)||void 0===l?void 0:l.user)||void 0===o?void 0:o.channel)||void 0===d?void 0:d.hypeTrain)?(0,t.jsx)(u.a,{}):(0,t.jsx)(u.f,{reason:"Failed to retrieve HypeTrain data"}):(0,t.jsx)(u.f,{reason:"Failed to retrieve Channel data"}):(0,t.jsx)(u.f,{reason:"Failed to retrieve User data"}):(0,t.jsx)(u.f,{reason:"Data is undefined"}):(0,t.jsx)(u.f,{reason:"ChannelLogin is undefined"}):null),(0,t.jsxs)(t.Fragment,{children:[f,(0,t.jsx)(C.Provider,{value:c,children:v})]})},w=function(e){var n,i,r=e.channelID,t=e.channelLogin,o=a.useRef((0,l.k3)()),u=(0,d.E_)({channelLogin:t,channelID:r}),S=u.data,L=u.loading,_=function(e){var n,i,r,t=e.channelID,l=e.data,o=a.useState(!1),u=o[0],d=o[1],h=a.useCallback((function(){d(!1)}),[]),p=null===(r=null===(i=null===(n=null==l?void 0:l.user)||void 0===n?void 0:n.channel)||void 0===i?void 0:i.hypeTrain.execution)||void 0===r?void 0:r.id,T=(0,v.Z)(p);return a.useEffect((function(){p!==T&&d(!1)}),[p,T,l]),(0,s.s)({topic:(0,f.tf)(t||""),skip:!t,onMessage:function(e){var n,i,r,a,o,u,v;if(e.type===c.PD.HypeTrainSharedChannelLeft){var s=e;if((null===(r=null===(i=null===(n=null==l?void 0:l.user)||void 0===n?void 0:n.channel)||void 0===i?void 0:i.hypeTrain.execution)||void 0===r?void 0:r.id)===s.data.id){var f=null===(v=null===(u=null===(o=null===(a=null==l?void 0:l.user)||void 0===a?void 0:a.channel)||void 0===o?void 0:o.hypeTrain.execution)||void 0===u?void 0:u.sharedHypeTrainDetails)||void 0===v?void 0:v.id,h=s.data.user.id;f===h&&h===t&&d(!0)}}}}),{currentChannelInitiatorLeft:u,clearInitiatorLeavingState:h}}({channelID:r,data:S}),C=_.currentChannelInitiatorLeft,b=_.clearInitiatorLeavingState,x=h({channelID:r,data:S}),m=x.nextMergeEvent,w=x.removeMergeEvent,P=function(e){var n,i,r,t,l,o,u,d,s,c,f=e.data,h=a.useRef(null),y=a.useRef(null),A=a.useRef(null),R=a.useRef(null),D=null===(r=null===(i=null===(n=null==f?void 0:f.user)||void 0===n?void 0:n.channel)||void 0===i?void 0:i.hypeTrain.execution)||void 0===r?void 0:r.progress.level.value,E=(0,v.Z)(D);a.useEffect((function(){D&&E&&D>E&&(h.current=y.current,y.current=g(f),A.current=R.current,R.current=T(f))}),[D,E,f]);var S=null===(u=null===(o=null===(l=null===(t=null==f?void 0:f.user)||void 0===t?void 0:t.channel)||void 0===l?void 0:l.hypeTrain)||void 0===o?void 0:o.execution)||void 0===u?void 0:u.endReason,I=(0,v.Z)(S);a.useEffect((function(){I!==S&&S===p.Yip.COMPLETED&&(h.current=y.current,y.current=g(f),A.current=R.current,R.current=T(f))}),[S,I,f]);var L=null===(c=null===(s=null===(d=null==f?void 0:f.user)||void 0===d?void 0:d.channel)||void 0===s?void 0:s.hypeTrain.execution)||void 0===c?void 0:c.id,_=(0,v.Z)(L);return a.useEffect((function(){L!==_&&(h.current=null,y.current=g(f),A.current=null,R.current=T(f))}),[L,_,f]),{previousLevelProgress:h,currentLevelProgress:y,previousLevelTotal:A,currentLevelTotal:R}}({data:S}),H=P.previousLevelProgress,M=P.currentLevelProgress,N=P.previousLevelTotal,U=P.currentLevelTotal,k=function(e){var n,i,r,t,l,o=e.data,u=a.useState(new Set),d=u[0],s=u[1],c=(0,v.Z)(o);a.useEffect((function(){var e,n,i,r,t,a,l,u,d,v,f,h=null===(i=null===(n=null===(e=null==o?void 0:o.user)||void 0===e?void 0:e.channel)||void 0===n?void 0:n.hypeTrain.execution)||void 0===i?void 0:i.id,p=null===(a=null===(t=null===(r=null==c?void 0:c.user)||void 0===r?void 0:r.channel)||void 0===t?void 0:t.hypeTrain.execution)||void 0===a?void 0:a.id;if(!c&&h){var T=y((null===(v=null===(d=null===(u=null===(l=o.user)||void 0===l?void 0:l.channel)||void 0===u?void 0:u.hypeTrain.execution)||void 0===d?void 0:d.sharedHypeTrainDetails)||void 0===v?void 0:v.sharedProgress)||[],null===(f=o.user)||void 0===f?void 0:f.id);s(new Set(T.map((function(e){return e.id}))))}else h!==p&&s(new Set)}),[o,c]);var f=null===(t=null===(r=null===(i=null===(n=null==o?void 0:o.user)||void 0===n?void 0:n.channel)||void 0===i?void 0:i.hypeTrain.execution)||void 0===r?void 0:r.sharedHypeTrainDetails)||void 0===t?void 0:t.sharedProgress;return{channelsWithNewRecords:(f?y(f,null===(l=o.user)||void 0===l?void 0:l.id):[]).filter((function(e){return!d.has(e.id)})),expireRecord:a.useCallback((function(e){s(new Set(d.add(e.id)))}),[d,s])}}({data:S}),O=k.channelsWithNewRecords,B=k.expireRecord,F=(0,A.z8)({data:S,currentChannelInitiatorLeft:C,clearInitiatorLeavingState:b,nextMergeEvent:m,removeMergeEvent:w,previousLevelProgress:H,currentLevelProgress:M,previousLevelTotal:N,currentLevelTotal:U,channelsWithNewRecords:O,expireRecord:B}),G=F.bannerState,Z=F.bannerStateMetadata,j=function(e){var n,i,r,t,l=e.data,o=e.bannerState,u=(0,R.Z)(null!==(i=null===(n=null==l?void 0:l.user)||void 0===n?void 0:n.id)&&void 0!==i?i:null,!0).emoteMap,d=a.useMemo((function(){var e,n,i,r;return null!==(r=null===(i=null===(n=null===(e=null==l?void 0:l.user)||void 0===e?void 0:e.channel)||void 0===n?void 0:n.hypeTrain.execution)||void 0===i?void 0:i.progress.level.value)&&void 0!==r?r:0}),[l]),v=a.useMemo((function(){var e,n,i,r,t,a,u,d,v=void 0;if((0,A.M4)(o)?v=null===(r=null===(i=null===(n=null===(e=null==l?void 0:l.user)||void 0===e?void 0:e.channel)||void 0===n?void 0:n.hypeTrain)||void 0===i?void 0:i.approaching)||void 0===r?void 0:r.potentialRewards:(0,A.o4)(o)&&(v=null===(d=null===(u=null===(a=null===(t=null==l?void 0:l.user)||void 0===t?void 0:t.channel)||void 0===a?void 0:a.hypeTrain)||void 0===u?void 0:u.execution)||void 0===d?void 0:d.config.potentialRewards),v)return v.filter((function(e){var n;return e.value.type===p.Asq.EMOTE&&"HypeTrainEmoteReward"===e.value.__typename&&!!(null===(n=e.value.emote)||void 0===n?void 0:n.id)&&!!e.value.emote.token&&e.value.emote.id!==D.D})).sort((function(e,n){return n.level-e.level}))}),[null===(t=null===(r=null==l?void 0:l.user)||void 0===r?void 0:r.channel)||void 0===t?void 0:t.hypeTrain,o]),s=a.useMemo((function(){var e,n,i=[],r=[];if(!v)return{lockedEmoteRewards:i,earnableEmoteRewards:r};for(var t=0,a=0,l=v;a<l.length;a++){var o=l[a];if(o.level<t)break;"HypeTrainEmoteReward"===o.value.__typename&&(null===(e=o.value.emote)||void 0===e?void 0:e.token)&&(null===(n=o.value.emote)||void 0===n?void 0:n.id)&&(u&&u[o.value.emote.token]||(o.level>=d?i.unshift(o):o.level>=t&&(t=o.level,r.unshift(o))))}return{lockedEmoteRewards:i,earnableEmoteRewards:r}}),[d,u,v]);return s}({data:S,bannerState:G}),$=j.lockedEmoteRewards,K=j.earnableEmoteRewards,Q=(0,I.UD)({bannerState:G,data:S,earnableEmoteRewardsLength:K.length,lockedEmoteRewardsLength:$.length}),V=Q.baselinePanelState,W=Q.pauseBaselinePanelCycle,q=Q.resumeBaselinePanelCycle;return{instanceID:o.current,channelID:(null===(i=null===(n=null==S?void 0:S.user)||void 0===n?void 0:n.channel)||void 0===i?void 0:i.id)||null,bannerState:G,bannerStateMetadata:Z,data:S,isShared:(0,E.yM)(S),loading:L,lockedEmoteRewards:$,earnableEmoteRewards:K,channelLogin:t,baselinePanelState:V,pauseBaselinePanelCycle:W,resumeBaselinePanelCycle:q}}},647605:function(e,n,i){i.d(n,{Qd:function(){return a},wb:function(){return l},wy:function(){return o}});var r=i(267924),t=i(478646),a=function(e,n){var i=(null==e?void 0:e.sharedHypeTrainDetails)?(0,t.vP)(e,n):null==e?void 0:e.progress.allTimeHighState;return null!=i?i:r.Q8_.NONE},l=function(e,n){return a(e,n)===r.Q8_.REACHED},o=function(e,n){var i=(null==e?void 0:e.sharedHypeTrainDetails)?(0,t.Jq)(e,n):null==e?void 0:e.allTimeHigh;return null!=i?i:void 0}},478646:function(e,n,i){i.d(n,{Jq:function(){return u},MP:function(){return a},q:function(){return o},vP:function(){return t},xt:function(){return l}});var r=i(267924),t=function(e,n){var i,r;return null===(r=null===(i=null==e?void 0:e.sharedHypeTrainDetails)||void 0===i?void 0:i.sharedProgress.find((function(e){return e.user.id===n})))||void 0===r?void 0:r.channelProgress.allTimeHighState},a=function(e,n){return t(e,n)===r.Q8_.REACHED},l=function(e,n){var i,r;return!!(null===(r=null===(i=null==e?void 0:e.sharedHypeTrainDetails)||void 0===i?void 0:i.sharedProgress.find((function(e){return e.user.id===n})))||void 0===r?void 0:r.channelProgress.total)},o=function(e,n){var i,r;return null===(r=null===(i=null==e?void 0:e.sharedHypeTrainDetails)||void 0===i?void 0:i.sharedConductors.find((function(e){return e.user.id===n})))||void 0===r?void 0:r.conductors},u=function(e,n){var i,r,t;return null!==(t=null===(r=null===(i=null==e?void 0:e.sharedHypeTrainDetails)||void 0===i?void 0:i.sharedAllTimeHighRecords.find((function(e){return e.user.id===n})))||void 0===r?void 0:r.channelAllTimeHigh)&&void 0!==t?t:void 0}},95159:function(e,n,i){i.d(n,{EQ:function(){return T},M4:function(){return f},SI:function(){return r},o4:function(){return p},z8:function(){return g}});var r,t=i(727234),a=i(726561),l=i(225745),o=i(917705),u=i(296540),d=i(267924),v=i(647605),s=i(74950);!function(e){e.Inactive="INACTIVE",e.Approaching="APPROACHING",e.Kickoff="KICKOFF",e.Starting="STARTING",e.Baseline="BASELINE",e.FastMode="FASTMODE",e.PreLevelUp="PRELEVELUP",e.LevelUp="LEVELUP",e.ATHReached="ATHREACHED",e.Merging="MERGING",e.Leaving="LEAVING",e.OtherChannelATHReached="OTHER_CHANNEL_ATH",e.Contributions="CONTRIBUTIONS",e.Ending="ENDING",e.RewardsDistributing="REWARDS_DISTRIBUTING",e.TreasureTrainDiscountReached="TT_DISCOUNT_REACHED"}(r||(r={}));var c=new Set([r.Approaching,r.Kickoff]),f=function(e){return c.has(e)},h=new Set([r.Starting,r.Baseline,r.FastMode,r.PreLevelUp,r.LevelUp,r.ATHReached,r.TreasureTrainDiscountReached,r.Ending,r.RewardsDistributing,r.Leaving,r.Merging,r.Contributions,r.OtherChannelATHReached]),p=function(e){return h.has(e)},T=function(e){return e===r.Leaving},g=function(e){var n,i,c,f,h,p,T,g,A,R=e.data,D=e.currentChannelInitiatorLeft,E=e.clearInitiatorLeavingState,S=e.nextMergeEvent,I=e.removeMergeEvent,L=e.previousLevelProgress,_=e.currentLevelProgress,C=e.previousLevelTotal,b=e.currentLevelTotal,x=e.channelsWithNewRecords,m=e.expireRecord,w=(0,t.Z)(R),P=u.useState((function(){return y(R)})),H=P[0],M=P[1],N=u.useState(null),U=N[0],k=N[1],O=(0,t.Z)(H),B=(0,t.Z)(U),F=function(e){"string"==typeof e?(M(e),k(null)):(M(e.type),k(e))},G=u.useRef(null),Z=u.useRef(null),j=u.useState(!1),$=j[0],K=j[1],Q=u.useState(!1),V=Q[0],W=Q[1],q=u.useCallback((function(){if(!R)return r.Inactive;var e=function(e){var n,i,t,a,l,o,u,c,f,h,p=null===(i=null===(n=null==w?void 0:w.user)||void 0===n?void 0:n.channel)||void 0===i?void 0:i.hypeTrain.execution,T=null===(a=null===(t=null==R?void 0:R.user)||void 0===t?void 0:t.channel)||void 0===a?void 0:a.hypeTrain.execution;return p&&!p.sharedHypeTrainDetails&&(null==T?void 0:T.sharedHypeTrainDetails)&&T.sharedHypeTrainDetails.sharedProgress.length<2?r.Starting:T?(0,s.$m)(R)?D?(E(),{type:r.Leaving,progress:T.progress}):S?(I(S.uuid),{type:r.Merging,mergeEvent:S}):!V&&T.isTreasureTrain&&(null===(f=T.treasureTrainDetails)||void 0===f?void 0:f.status)===d.lHC.REACHED&&(W(!0),p&&e!==r.Starting)?r.TreasureTrainDiscountReached:p&&p.progress.level.value<T.progress.level.value&&e!==r.LevelUp?T.isFastMode?r.LevelUp:r.PreLevelUp:!$&&(0,v.wb)(T,null===(h=null==R?void 0:R.user)||void 0===h?void 0:h.id)&&(K(!0),p&&e!==r.Starting)?r.ATHReached:x.length?(m(x[0]),{type:r.OtherChannelATHReached,channel:x[0]}):T.isFastMode?r.FastMode:r.Baseline:(null===(c=null===(u=null===(o=null===(l=R.user)||void 0===l?void 0:l.channel)||void 0===o?void 0:o.hypeTrain)||void 0===u?void 0:u.execution)||void 0===c?void 0:c.endReason)===d.Yip.COMPLETED?r.Ending:r.Inactive:p&&(null==p?void 0:p.sharedHypeTrainDetails)&&(0,s.$m)(w)?{type:r.Leaving,progress:p.progress}:r.Inactive};switch(H){case r.Inactive:return(0,s.$m)(R)?w?r.Starting:e(H):(0,s.B$)(R)?r.Approaching:r.Inactive;case r.Approaching:return(0,s.$m)(R)?r.Kickoff:(0,s.B$)(R)?r.Approaching:r.Inactive;case r.Starting:case r.Baseline:case r.FastMode:case r.ATHReached:case r.OtherChannelATHReached:case r.Merging:case r.Leaving:case r.TreasureTrainDiscountReached:return e(H);case r.Ending:return r.RewardsDistributing;case r.LevelUp:return(0,s.yM)(R)?{type:r.Contributions,previousProgressSnapshot:L.current,currentProgressSnapshot:_.current,previousTotalSnapshot:C.current,currentTotalSnapshot:b.current}:e(H);case r.RewardsDistributing:return(0,s.yM)(R)?{type:r.Contributions,previousProgressSnapshot:L.current,currentProgressSnapshot:_.current,previousTotalSnapshot:C.current,currentTotalSnapshot:b.current}:r.Inactive;case r.Contributions:return(0,s.$m)(R)?e(H):r.Inactive;case r.PreLevelUp:return r.LevelUp;case r.Kickoff:return r.Starting;default:return r.Inactive}}),[R,H,w,D,E,S,$,V,I,L,_,C,b,x,m]);u.useEffect((function(){var e,n,i,r,t,a;G.current||w===R&&!D&&!S||F(q()),w!==R&&(null===(i=null===(n=null===(e=null==w?void 0:w.user)||void 0===e?void 0:e.channel)||void 0===n?void 0:n.hypeTrain.execution)||void 0===i?void 0:i.id)!==(null===(a=null===(t=null===(r=null==R?void 0:R.user)||void 0===r?void 0:r.channel)||void 0===t?void 0:t.hypeTrain.execution)||void 0===a?void 0:a.id)&&(K(!1),W(!1))}),[R,w,H,q,D,S]);var z=(0,a.F)((function(){F(q()),G.current=null}));return u.useEffect((function(){var e,n,i;if(!(G.current||O===H&&B===U)){var t=-1;H===r.Kickoff?t=1500:H===r.Starting?t=13020:H===r.PreLevelUp?t=1e3:H===r.LevelUp?t=17050:H===r.Ending?t=(0,v.wb)(null===(n=null===(e=null==R?void 0:R.user)||void 0===e?void 0:e.channel)||void 0===n?void 0:n.hypeTrain.execution,null===(i=null==R?void 0:R.user)||void 0===i?void 0:i.id)?31005:19005:H===r.RewardsDistributing?t=2e4:H===r.ATHReached?t=8505:H===r.OtherChannelATHReached?t=1e4:H===r.Leaving?t=2e4:H===r.Merging?t=20005:H===r.Contributions?t=12e3:H===r.TreasureTrainDiscountReached&&(t=17050),t>-1&&(G.current=setTimeout((function(){return z.current()}),t))}}),[H,O,U,B,z,null===(i=null===(n=null==R?void 0:R.user)||void 0===n?void 0:n.channel)||void 0===i?void 0:i.hypeTrain.execution,null===(c=null==R?void 0:R.user)||void 0===c?void 0:c.id]),u.useEffect((function(){var e,n,i,t,a,l,u,d,v;H===r.Approaching?Z.current&&(null===(i=null===(n=null===(e=null==w?void 0:w.user)||void 0===e?void 0:e.channel)||void 0===n?void 0:n.hypeTrain.approaching)||void 0===i?void 0:i.expiresAt)===(null===(l=null===(a=null===(t=null==R?void 0:R.user)||void 0===t?void 0:t.channel)||void 0===a?void 0:a.hypeTrain.approaching)||void 0===l?void 0:l.expiresAt)||(Z.current&&(clearTimeout(Z.current),Z.current=null),!(null===(v=null===(d=null===(u=null==R?void 0:R.user)||void 0===u?void 0:u.channel)||void 0===d?void 0:d.hypeTrain.approaching)||void 0===v?void 0:v.expiresAt)||(0,o.isPast)(R.user.channel.hypeTrain.approaching.expiresAt)?z.current():Z.current=setTimeout((function(){return z.current()}),(0,o.differenceInMilliseconds)(R.user.channel.hypeTrain.approaching.expiresAt,new Date))):Z.current&&(clearTimeout(Z.current),Z.current=null)}),[H,null===(p=null===(h=null===(f=null==R?void 0:R.user)||void 0===f?void 0:f.channel)||void 0===h?void 0:h.hypeTrain.approaching)||void 0===p?void 0:p.expiresAt,z,null===(A=null===(g=null===(T=null==w?void 0:w.user)||void 0===T?void 0:T.channel)||void 0===g?void 0:g.hypeTrain.approaching)||void 0===A?void 0:A.expiresAt]),(0,l.i)((function(){var e,n;clearTimeout(null!==(e=G.current)&&void 0!==e?e:-1),clearTimeout(null!==(n=Z.current)&&void 0!==n?n:-1)})),{bannerState:H,bannerStateMetadata:U}},y=function(e){var n,i,t;if(e){if((0,s.B$)(e))return r.Approaching;if((0,s.$m)(e))return(null===(t=null===(i=null===(n=e.user)||void 0===n?void 0:n.channel)||void 0===i?void 0:i.hypeTrain.execution)||void 0===t?void 0:t.isFastMode)?r.FastMode:r.Baseline}return r.Inactive}},745277:function(e,n,i){i.d(n,{IS:function(){return u},eM:function(){return l},h9:function(){return f},xq:function(){return s}});var r=i(337930),t=i(478260),a="htc_1";function l(){return(0,r.fX)(a)}var o="wrong_phone_resting";function u(){return(0,r.fX)(o)}var d="htc_1",v="variant";function s(){var e=t.x2.experiments.__hardcodedStaleExperiment(d,"variant_with_remaining");return e===v||e===c}var c="variant_with_remaining";function f(){return t.x2.experiments.__hardcodedStaleExperiment(d,"variant_with_remaining")===c}}}]);